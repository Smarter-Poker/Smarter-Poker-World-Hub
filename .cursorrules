# ANTI GRAVITY 2.0 SYSTEM RULES

## üß† MEMORY FIRST
Before answering ANY prompt, you MUST:
1. Read `.memory/active_context.md` to understand current session state
2. Read `.memory/project_mission.md` to understand project goals and constraints
3. Update these files if plans change during the session

**Why:** Prevents context loss between sessions and ensures continuity.

---

## üîó CHAIN OF THOUGHT
Do not just write code. Explain your "Mental Sandbox" first:

**Template:**
```
I am analyzing [file/component/feature]...
I see a potential conflict with [rule/pattern/constraint]...
I will execute [strategy/approach] because [reasoning]...
```

**Why:** Makes decision-making transparent and catches errors before execution.

---

## üî• SCORCHED EARTH PROTOCOL

### Rule 1: No External Scripts for UI Logic
- All game logic must be React-native (state-driven)
- No `<script>` tags for gameplay or core functionality
- External libraries OK for utilities (charts, maps), but not for core business logic

### Rule 2: Self-Contained Components
- Components must work independently
- No hidden dependencies on global scripts
- All state management explicit (props, context, or Zustand)

### Rule 3: No 404s ‚Äî Mock Assets First
- If an image is missing, auto-generate a CSS/SVG fallback
- Never ship broken UI due to missing resources
- Fallbacks should be visually acceptable, not just error messages

**Why:** Ensures reliability and prevents cascading failures.

---

## üéØ PROJECT ISOLATION

### Workspace Verification
Before making ANY code changes, verify you are in the correct workspace:

**Triggers:**
- User mentions "Mapping" or "Venues" ‚Üí Verify in `hub-vanguard` workspace
- User mentions "Solver" or "Training" ‚Üí Verify correct orb context
- User mentions "Social" or "Feed" ‚Üí Verify Orb #1 context

**Rule:** Do not pollute one feature area with another's code.

**Why:** Prevents cross-contamination and maintains clean separation of concerns.

---

## üèóÔ∏è ARCHITECTURAL STANDARDS

### Visual Design
- **Glassmorphism:** `backdrop-filter: blur(10px)` for all major containers
- **Neon Accents:** Cyan (#00d4ff), Purple (#a855f7), Gold (#fbbf24)
- **Video Game Feel:** Smooth animations, micro-interactions, personality

### Code Patterns
- **Singleton Supabase Client:** Always import from `@/lib/supabaseClient`
- **RLS Enforcement:** All tables must have Row Level Security policies
- **No Sensitive Data in Client:** API keys stay server-side only

### Responsive Design
- **Pattern A (Content Zoom):** For content-heavy pages
- **Pattern B (Spatial Viewport):** For immersive experiences
- **Pattern C (Fixed Aspect):** For game boards and video players

**Reference:** See `.memory/system_patterns.md` for detailed specifications.

---

## üöÄ DEPLOYMENT LAW

### Rule: All Sessions Must Conclude with Deployment
**Standard Workflow:**
```bash
/auto-publish
```

**Manual Alternative:**
```bash
git add .
git commit -m "feat: [description]"
git push origin main
```

**Why:** Ensures production parity and prevents "works on my machine" issues.

---

## üîê SECURITY RULES

### 1. No Service Role Keys in Client Code
```javascript
// ‚úÖ CORRECT (server-side only)
const supabase = createClient(url, process.env.SUPABASE_SERVICE_ROLE_KEY);

// ‚ùå FORBIDDEN (client-side)
const supabase = createClient(url, process.env.SUPABASE_SERVICE_ROLE_KEY);
```

### 2. RLS Policies Required
Every Supabase table MUST have:
- Public read policy (if applicable)
- Authenticated write policy
- God mode override policy (for admin features)

### 3. Input Validation
- Sanitize all user inputs before database operations
- Use parameterized queries (Supabase handles this by default)
- Validate file uploads (type, size, content)

---

## üìä DATA PATTERNS

### Batch Execution Protocol
When inserting large datasets:
1. Split into batches: 30 ‚Üí 15 ‚Üí 3 rows
2. Add 5-10 second delays between batches
3. Verify each batch via API before proceeding
4. Log all successes/failures

**Why:** Prevents Supabase connection timeouts on bulk operations.

---

## üß™ VERIFICATION CHECKLIST

Before marking ANY feature "complete":
- [ ] Works on mobile (iOS Safari, Android Chrome)
- [ ] Works on desktop (Chrome, Safari, Firefox)
- [ ] No console errors
- [ ] Loading states implemented
- [ ] Error states handled gracefully
- [ ] Accessibility: keyboard navigation works
- [ ] Performance: smooth 60fps, no jank
- [ ] Production deployed and verified

---

## üéÆ ORBS & FEATURES

### Orb #4 (Training) ‚Äî Production Stable
- 100 games live
- React-native game logic (no external scripts)
- 4x4 grid mapping for range construction

### Orb #9 (Poker Near Me) ‚Äî In Progress
- GPS search with radius filtering
- Venue and tournament series discovery
- **Current Blocker:** Supabase infrastructure overload

### Orb #1 (Social) ‚Äî Dormant
- Link preview system production-verified
- Awaiting next activation phase

**Reference:** See `.memory/project_mission.md` for full orb manifest.

---

## üö® CRITICAL REMINDERS

1. **Read Memory Files First** ‚Äî Before every session
2. **Update Memory Files** ‚Äî When plans change
3. **Explain Before Executing** ‚Äî Chain of thought mandatory
4. **Verify Workspace** ‚Äî Before making changes
5. **Deploy at End** ‚Äî Every session concludes with deployment

**Failure to follow these rules will result in context loss, code pollution, and production issues.**

---

## üìù AGENT BEHAVIOR

### On Session Start
1. Read `.memory/active_context.md`
2. Read `.memory/project_mission.md`
3. Acknowledge current state in first response

### During Session
1. Explain reasoning before code changes
2. Update memory files if plans change
3. Verify workspace context before edits

### On Session End
1. Update `.memory/active_context.md` with progress
2. Deploy changes to production
3. Document any new blockers or issues

---

**VERSION:** Anti Gravity 2.0  
**LAST UPDATED:** 2026-01-19
